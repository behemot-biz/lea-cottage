{% extends 'base.html' %} 

{% block content %}
{% load static %}
{% load crispy_forms_tags %}


<div class="container">
    <div class="row">
        <div class="col card mb-4  mt-3 left  top">
            <div class="card-body">
                <!-- The post content goes inside the card-text. -->
                <!-- Use the | safe filter inside the template tags -->
           
                <h1>{{ stock_item.item.name }} </h1>
                {% if user.is_authenticated and stock_item.status == 1 %}
                <!-- Reserve Item Button -->
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#reserveModal">
                    Reserve Item
                </button>
                {% endif %}
                <p class="card-text">{{ stock_item.item_quantity }} {{ stock_item.quantity.unit }} - {{ stock_item.preserve.method }}</p>
                <!-- <p class="card-text">{{ stock_item.item.ingredients.description | safe }}</p> -->
                <p class="card-text">Status: {{ stock_item.get_status_display }}</p>
                <p id="id_reserved_by">{{ stock_item.reserved_by }}</p>
                <p  id="id_reserved_note">{{ stock_item.reserved_note }}</p>
                <p>
                    {% if user.is_authenticated and stock_item.status == 0 %}
                   <!-- Reserve Item Button -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#reserveModal">
    Reserve Item
</button>
                    {% else %}
                    <p>Log in to leave a comment</p>
                    {% endif %}
                    

                </p>

                <h3>Ingredients:</h3>
                <p class="card-text">
                    {% for ingredient in stock_item.item.ingredients.all %}
                        {{ ingredient.name }}{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </p>
            </div>
        </div>
    </div>
</div>

<!-- Reserve Item Modal -->
<div class="modal fade" id="reserveModal" tabindex="-1" aria-labelledby="reserveModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="reserveModalLabel">Reserve {{ stock_item.item.name }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form method="post" id="reserveForm">
                    {% csrf_token %}

                    <!-- {{ reserve_form|crispy }} -->
                    <div class="mb-3">
                        <label for="id_reserved_note" class="form-label">
                            {{ reserve_form.reserved_note.label }}
                        </label>
                        {{ reserve_form.reserved_note }}
                    </div>
                
                    <div class="mb-3">
                        <label for="id_reserved_date" class="form-label">
                            {{ reserve_form.reserved_date.label }}
                        </label>
                        {{ reserve_form.reserved_date }}
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary" form="reserveForm">Submit Reservation</button>
            </div>
        </div>
    </div>
</div>
{% endblock content %}

{% block extras %}
<!-- <script src="{% static 'js/reservation.js' %}"></script> -->
{% endblock %}