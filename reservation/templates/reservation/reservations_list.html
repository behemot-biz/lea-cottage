{% extends 'base.html' %} 

{% block content %}
{% load static %}


<div class="container">
    <div class="row">
        {% if reservation_page %}
        {{ reservation_page.title }}<br>
            {{ reservation_page.content }}
        {% else %}
            <p>No reservations available.</p>
        {% endif %}

        <hr>
        <h1>Reservation Details</h1>
        <p>Reservation ID: {{ current_reservation.reservation_id }}</p>
        <p>Reserved By: {{ current_reservation.reserved_by }}</p>
        <p>Reservation status: {{ current_reservation.get_reservation_complete_display }}</p>
        <p>Reservation date: {{ current_reservation.reserved_date }}</p>
        <p>Reservation note: {{ current_reservation.reserved_note }}</p>

        <b>Reserved Item(s):</b><br>
        {% for stock_item in current_reservation.get_stock_items %}
        <p>{{ stock_item.item.name }} (Quantity: {{ stock_item.item_quantity }})</p>
        {% endfor %}

        
        {% if current_reservation.reservation_complete == 0 %}
       <p> Current reservation id: {{ current_reservation.reservation_id }}</p>

        <form method="post" action="{% url 'complete_reservation' current_reservation.reservation_id %}">
        {% csrf_token %}

        <!-- Render form fields for note and pickup date -->

        <div class="mb-3">
            {{ form.reserved_date.label_tag }}
            {{ form.reserved_date }}
        </div>
        <div class="mb-3">
            {{ form.reserved_note.label_tag }}
            {{ form.reserved_note }}
        </div>

        <a href="{% url 'home' %}"><button type="button" class="btn btn-primary">Add More Items</button></a>
        <button type="submit" class="btn btn-primary">Complete Reservation</button>
        </form>
        {% else %}
        <div class="mb-3">
        <a href="#" class="btn btn-primary">Edit Reservation</a>
        </div>
        {% endif %}
    
        <H2>Previous Reservations</H2>

        {% for reservation in old_reservation %}
        
           <div> 
            id: {{ reservation.reservation_id }}<br>
            date: {{ reservation.reserved_date }}<br>
            date: {{ reservation.updated_on }}<br>
        
         <b>Items in this Reservation:</b><br>
       
             {% for stock_item in reservation.stock_items.all %}
                 
                     {{ stock_item.item.name }} - Quantity: {{ stock_item.stock_quantity }} - Preserve: {{ stock_item.preserve }}<br>
                 
             {% endfor %}

            </div>
        {% endfor %}

    </div>
</div>

{% endblock content %}